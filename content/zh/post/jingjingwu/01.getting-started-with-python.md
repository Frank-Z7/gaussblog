+++

title = "OpenGauss数据库之Python驱动快速入门"

date = "2021-04-04"

tags = ["openGauss step by step系列"] 

archives = "2021-04"

author = "吴京京" 

summary = "step by step系列之：openGauss1.0.1 Docker版本单机安装指南"

img = "/zh/post/jiangdianbin/title/img38.png" 

times = "22:59"

+++

# OpenGauss数据库之Python驱动

openGauss是一款开源关系型数据库管理系统，采用木兰宽松许可证v2发行。openGauss内核源自PostgreSQL，深度融合华为在数据库领域多年的经验，结合企业级场景需求，持续构建竞争力特性。

为了给大家介绍如何使用Python驱动连接OpenGauss数据库，我翻译了psycopg2的文档：[psycopg2中文文档](https://wjmcat.gitee.io/py-opengauss/)。

## 数据库部署

由于OpenGauss数据库与操作系统有一定的依赖关系，所以在简单应用上的开发，我推荐使用[Docker](https://hub.docker.com/r/enmotech/opengauss)来进行部署，部署的脚本如下所示：

```shell
# 拉取镜像
docker pull enmotech/opengauss

# 开启opengauss数据库服务
docker run --name opengauss --privileged=true -d -v /home/ubuntu/projects/opengauss/connect_test:/opengauss_test/ -e GS_PASSWORD=Secretpassword@123 -p 5432:5432 enmotech/opengauss:latest
```

在开启镜像服务之后，并没有创建对应的数据库，所以此时需要进入到Docker镜像当中来创建对应的数据库实例:
```shell
export GAUSSHOME=/usr/local/opengauss
export PATH=$GAUSSHOME/bin:$GAUSSHOME:$GAUSSHOME/lib:$PATH
export LD_LIBRARY_PATH=$GAUSSHOME/lib:$LD_LIBRARY_PATH
export DATADIR='/var/lib/opengauss/data'

docker exec -it opengauss /bin/bash
gsql -U gaussdb -W Secretpassword@123 -d postgres -p 5432
CREATE DATABASE test_db WITH ENCODING 'UTF8' template = template0;
gs_ctl reload -D $DATADIR
```

以上代码即可创建对应的数据库实例：`test_db`;

## 安装教程

```shell
pip install psycopg2-binary
```

## Getting Started

```python
import psycopg2

# 连接数据库
conn = psycopg2.connect("dbname=test user=opengauss")

# 打开数据库相关操作的游标对象
cur = conn.cursor() 

# 执行一个查询
cur.execute("SELECT * FROM my_data")

# 获取所有查询结果
records = cur.fetchall()
```

在以上代码中，展示了最简单的数据连接与数据库查询，使用方法非常简单，并符合[DB API v2](https://www.python.org/dev/peps/pep-0249/)的规范，从而让很多上有工具原生支持opengauss的操作，比如可直接在Sqlalchemy ORM工具中连接Opengauss数据库，这是一个非常重要的特性。

此处只是一个非常简单的数据库连接示例，后续我将持续发布一些深入的使用Opengauss Python数据库驱动的案例，录制了一个线上视频提供参考：

[BiliBili-opengauss使用之python驱动](https://www.bilibili.com/video/BV1G54y1b7g4/)

## 总结

Opengauss数据库是一个可处理高并发的高性能数据库，基于PostgreSql生态可轻松实现Python驱动应用程序的开发。
