**+++**<br />**title="openGauss社区入门(opengauss-逻辑备份命令)"**<br />**date="2022-08-19"**<br />**tags=["openGauss社区开发入门"]**<br />**archives=“2022-08”**<br />**author=“wangrururu”**<br />**summary="openGauss社区开发入门"**<br />**img="/zh/post/wzr/title/title.jpg"**<br />**times="19:15"**<br />**+++**<br />openGauss支持使用gs_dump工具导出表级的内容，包含表定义和表数据。视图、序列和外表属于特殊的表。用户可通过灵活的自定义方式导出表内容，不仅支持选定一个表或多个表的导出，还支持排除一个表或者多个表的导出。可根据需要自定义导出如下信息：<br />•导出表全量信息，包含表数据和表定义。<br />•仅导出数据，不包含表定义。<br />•仅导出表定义。<br />1.常用参数<br />（1）-U  连接数据库的用户名。<br />（2）-W  指定用户连接的密码。<br />（3）-f  将导出文件发送至指定目录文件夹。如果这里省略，则使用标准输出。<br />（4）-p 指定服务器所侦听的TCP端口或本地Unix域套接字后缀，以确保连接。<br />（5）dbname  需要导出的数据库名称。<br />（6）-t 指定导出的表（或视图、序列、外表），可以使用多个-t选项来选择多个表，也可以使用通配符指定多个表对象。<br />（7）-F 选择导出文件格式。-F参数值如下：<br />•p：纯文本格式<br />•c：自定义归档<br />•d：目录归档格式<br />•t：tar归档格式<br />（8）-T 不转储的表（或视图、或序列、或外表）对象列表，可以使用多个-t选项来选择多个表，也可以使用通配符指定多个表对象。<br />2.示例<br />（1）导出表的定义和数据，导出文件格式为文本格式。<br />gs_dump -f /home/opengauss300_0708/backup/m.sql -p 3436 postgres -t dd1 -F p<br />![image.png](https://cdn.nlark.com/yuque/0/2022/png/32435345/1660908148094-ccb6939f-cffd-4b41-9440-454eaf8361d6.png#clientId=ud815a6a8-8484-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=43&id=u6997755e&margin=%5Bobject%20Object%5D&name=image.png&originHeight=54&originWidth=554&originalType=binary&ratio=1&rotation=0&showTitle=false&size=65145&status=done&style=none&taskId=u74d1d0f3-090f-4bfd-bca1-dab80f3922d&title=&width=443.2)<br />（2）只导出表的数据，导出文件格式为tar归档格式。<br />gs_dump -f /home/opengauss300_0708/backup/m.tar -p 3436 postgres -t dd1 -a -F t <br />![image.png](https://cdn.nlark.com/yuque/0/2022/png/32435345/1660908162097-b217e7c4-7e67-49b1-98c8-69f796b746b8.png#clientId=ud815a6a8-8484-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=27&id=u43cdc23b&margin=%5Bobject%20Object%5D&name=image.png&originHeight=34&originWidth=554&originalType=binary&ratio=1&rotation=0&showTitle=false&size=37232&status=done&style=none&taskId=u88ffe901-057c-4233-bfe7-476253371a8&title=&width=443.2)<br />（3）导出表的定义，导出文件格式为目录归档格式。<br />gs_dump -f /home/opengauss300_0708/backup/m -p 3436 postgres -t dd1 -s -F d <br />![image.png](https://cdn.nlark.com/yuque/0/2022/png/32435345/1660908175403-885cce65-9c45-4b9f-a81d-1915d84fa625.png#clientId=ud815a6a8-8484-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=44&id=ub7383955&margin=%5Bobject%20Object%5D&name=image.png&originHeight=55&originWidth=554&originalType=binary&ratio=1&rotation=0&showTitle=false&size=64834&status=done&style=none&taskId=u1730ce70-058a-46b9-a0ee-6f957e076ce&title=&width=443.2)<br />（4）不导出表，导出文件格式为自定义归档格式。<br />gs_dump -f /home/opengauss300_0708/backup/m.dmp -p 3436 postgres -T dd1 -F c<br />![image.png](https://cdn.nlark.com/yuque/0/2022/png/32435345/1660908186579-1a0bc9e4-bc4f-4b11-b61b-99f9643bebc1.png#clientId=ud815a6a8-8484-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=44&id=u37964949&margin=%5Bobject%20Object%5D&name=image.png&originHeight=55&originWidth=554&originalType=binary&ratio=1&rotation=0&showTitle=false&size=65317&status=done&style=none&taskId=u86606486-7061-4325-b722-5facd291159&title=&width=443.2)<br />（5）同时导出两个表，导出文件格式为文本格式。<br />gs_dump -f /home/opengauss300_0708/backup/m1.sql -p 3436 postgres -t dd1 -t dd2 -F p<br />![image.png](https://cdn.nlark.com/yuque/0/2022/png/32435345/1660908193429-7b55a105-21d5-4403-bc8b-0ce1a2f6cc6a.png#clientId=ud815a6a8-8484-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=41&id=u3441ebac&margin=%5Bobject%20Object%5D&name=image.png&originHeight=51&originWidth=554&originalType=binary&ratio=1&rotation=0&showTitle=false&size=56558&status=done&style=none&taskId=u14bc59fa-7f8f-474a-8892-cef500dec5d&title=&width=443.2)<br />（6）导出时，排除两个表，导出文件格式为文本格式。<br />gs_dump -f /home/opengauss300_0708/backup/m2.sql -p 3436 postgres -T dd1 -T dd2 -F p<br />![image.png](https://cdn.nlark.com/yuque/0/2022/png/32435345/1660908202991-7917b5b2-dbc4-453c-a672-4bcaf6ca17e4.png#clientId=ud815a6a8-8484-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=39&id=u4bec73f4&margin=%5Bobject%20Object%5D&name=image.png&originHeight=49&originWidth=554&originalType=binary&ratio=1&rotation=0&showTitle=false&size=58012&status=done&style=none&taskId=ube29a4c1-9098-426f-a22a-c880526dbb1&title=&width=443.2)<br />（7）导出表1的定义和数据，只导出表2的定义，导出文件格式为tar归档格式。<br />gs_dump -f /home/opengauss300_0708/backup/m3.tar -p 3436 postgres -t dd1 -t dd2 --exclude-table-data dd2 -F t<br />![image.png](https://cdn.nlark.com/yuque/0/2022/png/32435345/1660908214236-508c8634-0957-4f5f-959b-bd8be7d76fc3.png#clientId=ud815a6a8-8484-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=33&id=uab5304a9&margin=%5Bobject%20Object%5D&name=image.png&originHeight=41&originWidth=554&originalType=binary&ratio=1&rotation=0&showTitle=false&size=43063&status=done&style=none&taskId=u616f3469-2577-4f69-a76b-915ec94d682&title=&width=443.2)<br />（8）导出表的定义和数据，并对导出文件进行加密，导出文件格式为文本格式。<br />gs_dump -f /home/opengauss300_0708/backup/m4.sql -p 3436 postgres -t dd1 --with-encryption AES128 --with-key abcdefg_?1234567 -F p<br />![image.png](https://cdn.nlark.com/yuque/0/2022/png/32435345/1660908222439-01895d2b-b756-4db1-a6c5-9157ce3a157a.png#clientId=ud815a6a8-8484-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=36&id=u1e54b1e4&margin=%5Bobject%20Object%5D&name=image.png&originHeight=45&originWidth=554&originalType=binary&ratio=1&rotation=0&showTitle=false&size=40671&status=done&style=none&taskId=uf2d174ee-05ae-43b0-b3d4-7ea502f72ed&title=&width=443.2)<br />（9）导出public模式下所有表（包括视图、序列和外表）和自定义模式中的表，包含数据和表定义，导出文件格式为自定义归档格式。<br />gs_dump -f /home/opengauss300_0708/backup/m5.dmp -p 3436 postgres -t public.* -t myschema.dd1 -F c<br />![image.png](https://cdn.nlark.com/yuque/0/2022/png/32435345/1660908230084-ce873cb7-dc6a-4c97-84b7-3412c670a9a4.png#clientId=ud815a6a8-8484-4&crop=0&crop=0&crop=1&crop=1&from=paste&height=37&id=u5d51992e&margin=%5Bobject%20Object%5D&name=image.png&originHeight=46&originWidth=554&originalType=binary&ratio=1&rotation=0&showTitle=false&size=50842&status=done&style=none&taskId=ud926a090-a7be-425b-8491-aac913d82ca&title=&width=443.2)
